@page
@using System.Text
@model UzlezzBlogs.Pages.SearchModel
@{
    ViewData["Title"] = $"Search `{Model.Query}` | Page {Model.PageIndex}";
    ViewData["SearchQuery"] = Model.Query;

    var description = new StringBuilder();
    foreach (var post in Model.Posts)
    {
        description.Append(" | \"");
        if (post.Title.Length > 25)
            description.Append(post.Title.AsSpan().Slice(0, 25)).Append("...");
        else
            description.Append(post.Title);
        description.Append("\" by ").Append(post.User);
    }
}

@section AdditionalMeta {
    <meta name="description" content="@ViewData["Title"]@description" />
}

<div class="container py-5" style="max-width: 800px;">
    <h2 class="text-center">Search for "@Model.Query"</h2>
    @foreach (var post in Model.Posts)
    {
        <post-preview-card post="@post" />
    }

    <pagination page-index="@Model.PageIndex"
                total-pages="@Model.TotalPages"
                generate-url="@((page) => $"/?query={Model.Query}&page={page}")" />
</div>